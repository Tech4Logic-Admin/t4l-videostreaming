namespace T4L.VideoSearch.Api.Infrastructure.Adapters;

/// <summary>
/// Abstraction for malware scan status provider
/// </summary>
public interface IMalwareScanStatusProvider
{
    /// <summary>
    /// Get the malware scan status for a blob
    /// </summary>
    Task<MalwareScanResult> GetScanStatusAsync(string containerName, string blobName, CancellationToken ct = default);
}

public record MalwareScanResult(
    MalwareScanState State,
    bool IsMalicious,
    string? ThreatType,
    DateTime? ScannedAt
);

public enum MalwareScanState
{
    Pending,
    InProgress,
    Completed,
    Error
}
